# Генератор мелодий

Проект для генерации музыкальных мелодий на основе заданной тональности, типа гаммы и темпа. Поддерживает экспорт в MIDI, визуализацию в виде пиано-ролла и воспроизведение.

## Цель проекта

Создать инструмент для программной генерации музыкальных последовательностей с возможностью настройки параметров, визуализации и экспорта для последующего использования в DAW или прослушивания.

## Возможности

- **Генерация мелодий** на основе различных гамм (мажор, минор, пентатоника, блюз и др.)
- **Экспорт в MIDI** для использования в музыкальных программах
- **Визуализация** в виде пиано-ролла
- **Воспроизведение** сгенерированных мелодий
- **GUI интерфейс** на Tkinter
- **Консольный интерфейс** для быстрой генерации

## Структура проекта

```
melody-generator/
├── app.py                 # GUI приложение (Tkinter)
├── main.py                # Консольный интерфейс
├── pyproject.toml         # Конфигурация проекта
├── requirements.txt       # Зависимости
├── requirements-dev.txt   # Зависимости для разработки
├── Makefile               # Команды для разработки
├── src/
│   ├── entities/          # Сущности (модели данных)
│   │   ├── note.py        # Музыкальная нота
│   │   ├── melody.py      # Мелодия (последовательность нот)
│   │   ├── scale.py       # Гамма и тональности
│   │   └── settings.py    # Настройки генератора
│   └── services/          # Сервисы (бизнес-логика)
│       ├── generator.py   # Генератор мелодий
│       ├── exporter.py    # Экспорт в MIDI
│       ├── visualizer.py  # Визуализация
│       └── player.py      # Воспроизведение
```

## Принцип работы алгоритма

1. **Выбор гаммы**: На основе тональности (C, D, F# и др.) и типа гаммы (мажор, минор и др.) определяется набор допустимых интервалов.

2. **Генерация нот**: Для каждой ноты мелодии:
   - Случайно выбирается интервал из гаммы
   - Случайно выбирается октава в заданном диапазоне
   - Случайно выбирается длительность (четверть, восьмая, шестнадцатая)

3. **Экспорт**: Ноты преобразуются в MIDI-сообщения с учётом темпа.

## Установка и запуск

### 1. Клонирование и настройка окружения

```bash
git clone <repository-url>
cd melody-generator
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 2. Запуск GUI приложения

```bash
python app.py
```

### 3. Запуск консольного интерфейса

```bash
python main.py
```

## Пример работы

### Консольный интерфейс

```
==================================================
       ГЕНЕРАТОР МЕЛОДИЙ
==================================================

Нажмите Enter для значений по умолчанию [в скобках]

Доступные тональности: A, A#, Ab, B, Bb, C, C#, D, D#, Db, E, Eb, F, F#, G, G#, Gb
Тональность [C]: 

Доступные гаммы: major, minor, pentatonic_major, pentatonic_minor, blues, dorian, mixolydian
Тип гаммы [major]: minor

Количество нот (1-64) [8]: 
Темп в BPM (40-300) [120]: 

==================================================
Тональность: C minor
Темп: 120 BPM
Нот: 8
==================================================

Сгенерированная мелодия

Eb4: ██  (0.5 долей)
G4: ████  (1.0 долей)
C5: █  (0.25 долей)
Bb4: ██  (0.5 долей)
...

MIDI файл сохранён: output.mid
```

### GUI интерфейс

![GUI Screenshot](docs/screenshot.png)

Интерфейс позволяет:
- Выбрать тональность и тип гаммы из выпадающих списков
- Настроить количество нот, темп и диапазон октав с помощью слайдеров
- Сгенерировать мелодию одной кнопкой
- Просмотреть пиано-ролл визуализацию
- Воспроизвести и сохранить результат

## Доступные гаммы

| Тип | Описание | Характер |
|-----|----------|----------|
| major | Мажорная гамма | Радостный, светлый |
| minor | Минорная гамма | Грустный, тёмный |
| pentatonic_major | Мажорная пентатоника | Народный, мелодичный |
| pentatonic_minor | Минорная пентатоника | Блюзовый, роковый |
| blues | Блюзовая гамма | Джазовый, выразительный |
| dorian | Дорийский лад | Минорный с мажорным оттенком |
| mixolydian | Миксолидийский лад | Мажорный с минорным оттенком |

## Разработка

### Установка инструментов разработки

```bash
pip install -r requirements-dev.txt
pre-commit install
```

### Полезные команды

```bash
make format   # Форматирование кода (isort + black)
make lint     # Проверка линтером (ruff)
make run      # Запуск main.py
```

## Технологии

- **Python 3.11+**
- **mido** — работа с MIDI
- **matplotlib** — визуализация
- **pygame** — воспроизведение MIDI
- **Tkinter** — GUI интерфейс

## Автор

Токунова Полина, 22ФПЛ1
